<html>
<META HTTP-EQUIV="CACHE-CONTROL" CONTENT="NO-CACHE"/>
<META HTTP-EQUIV="EXPIRES" CONTENT="Mon, 22 Jul 2002 11:00:00 GMT"/>
<head>
  <script type="module">
import * as kaspa from "./kaspa/kaspa.js";

let {Transaction} = kaspa;

var networkId = "testnet-11";	
var rpc;

const queryString = window.location.search;
const urlParams = new URLSearchParams(queryString);

var transactionSafeJSON = document.getElementById('transactionSafeJSON');
var transaction;

(async ()=> {
  try{
    const wasm = await kaspa.default("./kaspa/kaspa_bg.wasm");
    transactionSafeJSON.textContent = urlParams.get('transactionSafeJSON');
    transaction = Transaction.deserializeFromJSON(transactionSafeJSON.textContent);
  }catch(e){
    var content = window.document.getElementById('content');
    content.textContent='Invalid transaction format in url param transactionSafeJSON, or it is missing. This page is exclusive to add script key to unlock utxos and sign transactions.'
  }
})();

function sign(){
  try{
    transaction = Transaction.deserializeFromJSON(transactionSafeJSON.textContent);
    
  }catch(e){
    alert(e)
  }  
}
window.sign=sign;


function submitTransaction(){
}
window.submitTransaction=submitTransaction;

  </script>
</head>
<body>
<div id="content">
The following transaction was sent to be signed:
<textarea style="width:100%; height=70%;" id="transactionSafeJSON">
</textarea>
Script key to unlock:
<input type="text" name="data" value="" style="width:100%"/>
<input type="BUTTON" value="AddOpData" onclick="sign">
<br/>
Type your privkey:
<textarea style="width:100%" id="privkey" rows="2">
</textarea>
<input type="BUTTON" value="Sign" onclick="sign">
<input type="BUTTON" value="Submit Transaction" onclick="submitTransaction">
* data input should be in hexadecimal format
</div>
</body>

</html>
